# Cookie Profile Switcher - Chrome扩展程序

## 项目简介

Cookie Profile Switcher是一款Chrome浏览器扩展程序，帮助用户在每个域名下存储和管理多个cookie配置文件。用户可以轻松管理所有网站的多个cookie会话，无需反复注销和登录来切换用户配置文件。

## 主要功能

### 🎯 核心功能
- **多配置文件管理**：为每个域名创建和存储多个cookie配置文件
- **自动默认配置**：首次使用自动创建默认配置文件，降低使用门槛
- **一键切换**：在不同配置文件之间快速切换，无需重新登录
- **智能状态保存**：切换配置文件前自动保存当前状态，无状态丢失
- **双重配置模式**：支持保存当前状态和创建空配置文件两种方式 ⭐ 新增
- **空配置文件**：提前创建配置文件，登录后自动关联Cookie状态 ⭐ 新增
- **配置文件重命名**：支持修改已保存配置文件的名称 ⭐ 新增
- **智能自动更新**：空配置文件自动检测登录状态并更新关联 ⭐ 新增
- **智能识别**：自动识别当前网站域名，显示对应的配置文件列表
- **Cookie诊断**：智能分析Cookie获取问题，提供详细诊断报告和解决建议
- **多语言支持**：支持中文和英文界面，根据浏览器语言自动切换 ⭐ 新增

### 🔧 适用场景
- 管理多个社交媒体账户（微博、Twitter、Facebook等）
- 切换不同的电子邮件账户（Gmail、Outlook等）
- 管理多个电子商务账户（淘宝、京东、亚马逊等）
- 开发测试中需要切换不同用户身份
- 家庭共用电脑时的账户管理

## 使用方法

### 基本操作

#### 🚀 首次使用（自动创建默认配置）
1. **登录网站**：在任意网站正常登录你的账户
2. **打开插件**：点击扩展程序图标
3. **自动创建**：插件会自动将当前状态保存为"默认配置" ⭐ 新功能
4. **开始使用**：现在可以创建更多配置文件或直接切换

#### 📝 创建新配置文件
1. **切换账户**：登录不同的账户或修改当前状态
2. **保存配置**：点击"保存为新配置文件"按钮
3. **命名配置**：为配置文件起一个便于识别的名称（如"工作账户"）
4. **配置完成**：新配置文件已创建并可切换

#### 🔄 切换配置文件
1. **选择配置**：在配置文件列表中选择要切换的配置文件
2. **一键切换**：点击"切换"按钮
3. **自动保存**：插件自动保存当前状态到默认配置 ⭐ 新功能
4. **应用配置**：页面自动刷新并应用新的cookie状态

3. **管理配置文件**：
   - 重命名配置文件
   - 删除不需要的配置文件
   - 更新现有配置文件的cookie状态

4. **Cookie诊断**：
   - 遇到Cookie获取问题时，点击"Cookie诊断"按钮
   - 查看详细的诊断报告，了解问题原因
   - 按照建议进行问题排查和解决

### 界面说明
- **当前域名显示**：显示当前网站的域名
- **配置文件列表**：显示当前域名下的所有已保存配置文件
- **操作按钮**：
  - `切换`：应用选中的配置文件
  - `同步`：用当前cookie状态更新选中的配置文件
  - `重命名`：修改配置文件的名称
  - `删除`：删除选中的配置文件
  - `创建新配置文件`：保存当前状态或创建空配置文件
  - `Cookie诊断`：分析Cookie获取问题并提供解决建议

## 技术架构

### 文件结构
```
switch_profile/
├── manifest.json          # 扩展程序配置文件
├── background.js          # 后台服务脚本
├── popup.html            # 弹出窗口界面
├── popup.js              # 弹出窗口脚本
├── popup.css             # 弹出窗口样式
├── _locales/             # 多语言文件夹
│   ├── zh/               # 中文语言包
│   │   └── messages.json # 中文消息文件
│   └── en/               # 英文语言包
│       └── messages.json # 英文消息文件
├── icons/                # 图标文件夹
│   ├── icon16.png
│   ├── icon32.png
│   ├── icon48.png
│   └── icon128.png
└── README.md             # 项目说明文档
```

### 核心模块
1. **Cookie管理模块** (`background.js`)
   - 获取指定域名的所有cookie
   - 保存cookie配置文件到本地存储
   - 恢复cookie配置文件
   - 清除指定域名的cookie

2. **用户界面模块** (`popup.js/html/css`)
   - 显示当前域名
   - 展示配置文件列表
   - 处理用户操作（创建、切换、删除配置文件）
   - 与后台脚本通信

3. **多语言模块** (`_locales/`)
   - 中文语言包（zh/messages.json）
   - 英文语言包（en/messages.json）
   - 使用Chrome i18n API自动切换语言
   - 支持界面文本、按钮、提示信息的完整本地化
   
   **语言切换管理**：
   - **显示英文界面**：将中文语言包重命名为备份（`zh_backup`）
   - **显示中文界面**：将备份的语言包恢复为活动状态（`zh`）
   - **自动语言切换**：同时保留两个语言包，根据浏览器UI语言自动选择

4. **数据存储模块**
   - 使用Chrome扩展程序的storage API
   - 存储格式：`{domain: {profileName: cookieData}}`

### 权限说明
- `cookies`：访问和修改网站cookie
- `storage`：本地存储配置文件数据
- `activeTab`：获取当前活跃标签页信息
- `host_permissions: ["<all_urls>"]`：访问所有网站的cookie

## 安全与隐私

### 数据安全
- 所有cookie数据仅存储在用户本地
- 使用Chrome扩展程序的安全存储API
- 不会向任何服务器发送用户数据

### 隐私保护
- 仅在用户明确操作时保存cookie
- 用户可以随时删除任何配置文件
- 透明的数据操作，用户完全掌控

## 开发说明

### 开发环境要求
- Chrome浏览器（版本88+）
- 支持Manifest V3的开发环境

### 安装步骤
1. 克隆或下载项目文件
2. 打开Chrome浏览器，进入 `chrome://extensions/`
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目文件夹

### 调试方法
- 右键点击扩展程序图标 → 审查弹出内容（调试popup）
- 在扩展程序管理页面点击"背景页"（调试background script）
- 使用Chrome DevTools进行调试

## 💰 收费策略说明

### Freemium商业模式
本项目已为未来的收费功能做好技术准备，采用**免费增值（Freemium）**模式：

#### 免费版限制
- 每个域名最多创建 **3个配置文件**
- 每天最多切换 **20次**
- 核心功能完整可用

#### 高级版特权
- ✅ **无限配置文件数量**
- ✅ **无限切换次数**  
- ✅ **批量导入/导出**（计划中）
- ✅ **云同步功能**（计划中）
- ✅ **优先技术支持**

#### 技术实现亮点
- 🔧 完整的许可证管理系统
- ⚙️ **收费功能开关配置**：通过config.js灵活控制收费功能开启/关闭🆕
- 🛠️ **开发者工具支持**：便捷的命令行工具切换收费状态🆕
- 🎨 友好的升级提示界面
- 📊 实时使用统计显示
- 🌐 多语言支持（中英文）
- 🛡️ 本地存储，保护隐私
- 📈 **配置文件统计功能**：专门的统计页面，一体化管理所有域名的配置文件

#### 新增：配置文件统计功能 🆕
- **统计总览页面**：点击总配置文件数字跳转到专门的统计页面
- **全域名视图**：一目了然地查看所有域名下的配置文件
- **搜索和排序**：快速查找和管理配置文件
- **一体化管理**：在统计页面直接进行切换、更新、删除操作
- **美观界面**：现代化设计，响应式布局，流畅动画效果

> **注意**：当前所有功能均为免费使用，收费功能仅作为技术演示和未来规划。

详细的收费策略和实施计划请参考：
- [收费策略规划文档](docs/收费策略规划.md)
- [收费功能开关配置指南](docs/收费功能开关配置指南.md)🆕
- [配置文件统计功能说明](docs/配置文件统计功能说明.md)
- [删除域名功能说明](docs/删除域名功能说明.md)
- [域名跳转和Cookie详情功能说明](docs/域名跳转和Cookie详情功能说明.md)🆕
- [Cookie详情功能调试指南](docs/Cookie详情功能调试指南.md)🆕

## 项目完成情况

### ✅ 已完成功能
- **核心功能完整实现**：
  - ✅ Cookie配置文件的保存和恢复
  - ✅ 多域名支持，每个域名独立管理
  - ✅ 配置文件的创建、切换、更新、删除
  - ✅ 一键清除Cookie功能
  
- **用户界面完善**：
  - ✅ 现代化、美观的弹出窗口界面
  - ✅ 直观的操作按钮和状态显示
  - ✅ 模态对话框交互
  - ✅ 实时通知反馈系统
  - ✅ 响应式设计支持
  
- **技术架构稳定**：
  - ✅ 基于Chrome Manifest V3
  - ✅ 完善的错误处理和日志记录
  - ✅ 异步操作和性能优化
  - ✅ 代码结构清晰，遵循SOLID原则

- **收费功能架构**：⭐ 新增
  - ✅ Freemium商业模式支持
  - ✅ 收费功能开关配置（config.js）🆕
  - ✅ 开发者工具支持（dev-tools.js）🆕
  - ✅ 许可证管理系统（LicenseManager）
  - ✅ 免费版使用限制（配置文件数量、切换次数）
  - ✅ 高级版升级界面和许可证激活
  - ✅ 使用统计和限制提示
  - ✅ 完整的多语言支持

- **配置文件统计功能**：🆕 全新
  - ✅ 专门的统计页面（profiles-overview.html）
  - ✅ 点击式快速跳转（总配置文件数字可点击）
  - ✅ 全域名配置文件一览
  - ✅ 实时搜索和多维度排序
  - ✅ 在线管理（切换、更新、删除）
  - ✅ 域名级删除（一键删除整个域名及其所有配置文件）🆕
  - ✅ 点击域名跳转（一键访问对应网站）🆕
  - ✅ Cookie详情展示（查看配置文件的具体Cookie信息）🆕
  - ✅ 美观的现代化界面设计
  - ✅ 安全的事件处理（修复特殊字符导致的点击问题）

### 📋 安装和使用步骤

#### 第一步：准备图标文件
1. 查看 `icons/图标制作说明.md` 了解图标制作方法
2. 制作或下载所需的4个PNG图标文件：
   - icon16.png (16x16)
   - icon32.png (32x32) 
   - icon48.png (48x48)
   - icon128.png (128x128)
3. 将图标文件放置在 `icons/` 目录中

#### 第二步：安装扩展程序
1. 打开Chrome浏览器
2. 在地址栏输入 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择本项目文件夹 `switch_profile`
6. 扩展程序安装完成！

#### 第三步：语言设置（可选）
默认显示英文界面。如需切换语言：

**切换到中文界面**：
```cmd
Move-Item _locales\zh_backup _locales\zh
```
然后重新加载扩展程序。

**切换回英文界面**：
```cmd
Move-Item _locales\zh _locales\zh_backup  
```
然后重新加载扩展程序。

#### 第四步：配置收费功能（可选）
默认情况下，收费功能是关闭的，所有功能免费使用。如需启用收费功能：

```javascript
// 修改 config.js 文件
const CONFIG = {
    BILLING: {
        ENABLED: true,  // 改为 true 启用收费功能
        FREE_LIMITS: {
            MAX_PROFILES_PER_DOMAIN: 3,
            MAX_DAILY_SWITCHES: 20
        }
    }
};
```

或使用开发者工具快速切换：
```javascript
// 在浏览器控制台中执行
devTools.enableBilling()   // 启用收费功能
devTools.disableBilling()  // 关闭收费功能
devTools.help()            // 查看所有可用命令
```

#### 第五步：开始使用
1. **访问任意网站**并登录你的账户
2. **点击扩展程序图标**（浏览器工具栏中的Cookie图标）
3. **保存配置文件**：点击"保存当前状态"按钮，输入配置文件名称
4. **切换配置文件**：在配置文件列表中点击"切换"按钮
5. **管理配置文件**：使用"更新"和"删除"按钮管理已保存的配置文件

## 更新日志

### v1.2.0（最新版本） ⭐ 
- ✅ **多语言支持**：支持中文和英文界面，根据浏览器语言自动切换
- ✅ **国际化架构**：使用Chrome扩展程序i18n API实现完整国际化
- ✅ **智能语言识别**：自动检测用户浏览器语言设置
- ✅ **完整本地化**：所有界面文本、按钮、提示信息全面本地化

### v1.1.0 ⭐ 
- ✅ **默认配置文件功能**：首次使用自动创建默认配置文件
- ✅ **智能状态保存**：切换配置文件前自动保存当前状态
- ✅ **界面优化**：默认配置的特殊标识和视觉效果
- ✅ **操作简化**：降低使用门槛，新用户可立即开始使用
- ✅ **完善保护机制**：默认配置不能删除，只能更新

### v1.0.0（已完成）
- ✅ 完整的cookie配置文件管理功能
- ✅ 现代化用户界面设计和实现
- ✅ 多域名支持和数据隔离
- ✅ 完善的错误处理和用户反馈
- ✅ **Cookie诊断功能**：智能分析Cookie获取问题并提供解决建议
- ✅ 详细的使用文档和图标制作指导

## 技术特点

### 设计原则
- **单一职责原则**：每个模块专注于特定功能
- **开放封闭原则**：易于扩展新功能
- **依赖倒置原则**：高层模块不依赖低层模块
- **接口隔离原则**：精简的接口设计

### 错误处理
- 完善的错误捕获和日志记录
- 用户友好的错误提示
- 异常情况的降级处理

### 性能优化
- 异步操作避免阻塞UI
- 最小化存储空间占用
- 高效的cookie操作

## 问题反馈

如果在使用过程中遇到任何问题或有改进建议，请及时反馈。

## 许可证

本项目仅供学习和个人使用。 